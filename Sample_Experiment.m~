function Sample_Experiment(subNo, signList)


addpath(
%The sign meaning experiment, Feb 2014
%
%subNo, the subject number to run. Subject code above
%99 is for testing; data overwrite will not be checked.
%
%signlist, one of eight set lists of items, specify 1-8
%
%Note: Make sure that you add the helper functions to the path, otherwise
%it won't work. You can do this by clicking on the folder helper functions
% -> add to path.



%%%%%%%%%%%%%%%%%%%%%%%%%
% Preliminary stuff
%%%%%%%%%%%%%%%%%%%%%%%%%

global parameters

% File handling - makes the file where data will be stored
parameters.datafilepointer = AssignDataFile('SampleExp',subNo);

try %everything goes inside a 'try' block, so if it crashes, it crashes 
    %cleanly (and maybe even tells us what went wrong)
    
    disp('Hey!')
    
    %%%%%%%%%%%%%%%%%%%%%%
    % Parameter Setting
    %%%%%%%%%%%%%%%%%%%%%%
    
    % PsychTool setup
     Setup_PTool();
     SetParameters();
      
    % Sets specific values for this participant
    parameters.subNo = subNo;

    %%%%%%%%%%%%%%%%%%%%%%
    % Randomization of files, conditions, etc. goes here! An example is
    % below (Annemarie K.)
    %%%%%%%%%%%%%%%%%%%%%%
    
    
%    
%    
%
%     %Read the file into matlab
%
% Note: ';' below depicts the delimeter in the csv file. Depending on the file, 
% this can either be ';' or ',' (or tab) (you can check this by printing the file,
% so without ; at the end of the line).
%
%
    vidNames = read_mixed_csv('thiswillwork3.csv',';')
%     
%
%
%
%     %Routine to pick the specified signList (algebra to get us the right rows)
    
     %ORIGINAL
%     start_Index = 14*(signList-1)+2
%     end_Index = 14*signList + 1
%     vidNames(start_Index:end_Index,:)

% Try

     start_Index = 27*(signList-1)+2;
     end_Index = 27*signList + 1;
     
     %MK debug 9/13
     %start_Index = 2;
     %end_Index = 8;



%     
%
%
%     %Turn list into vectors of variables
%   ORIGINAL
%     parameters.Item = vidNames(start_Index:end_Index, 2)
%     parameters.Contrast = vidNames(start_Index:end_Index, 3)
%     parameters.Type_Target = vidNames(start_Index:end_Index, 4)
%     parameters.Target = vidNames(start_Index:end_Index, 5)
%     parameters.Distractor = vidNames(start_Index:end_Index, 6)
%     parameters.Cohort = vidNames(start_Index:end_Index, 7)
%     parameters.SignerID = vidNames(start_Index:end_Index, 8)
    
    
    % Trying to make new ones
    
    parameters.amyFileName = vidNames(start_Index:end_Index, 2);
%These are the names of the files that are used to make this list:
%MannerOfMotionCondition, 

    parameters.itemID = vidNames(start_Index:end_Index, 3)

    parameters.eventType = vidNames(start_Index:end_Index, 4)
%This is either Motion or Causal

    parameters.Condition = vidNames(start_Index:end_Index, 5)
%The conditions: Manner, Path, Effect, Means

    parameters.Manner = vidNames(start_Index:end_Index, 6)

    parameters.Path = vidNames(start_Index:end_Index, 7)

    parameters.verbName = vidNames(start_Index:end_Index, 8)

    parameters.verbMeaning = vidNames(start_Index:end_Index, 9)

    parameters.ambigS = vidNames(start_Index:end_Index, 10)

    parameters.mbiasAns = vidNames(start_Index:end_Index, 13)
                       
    parameters.pbiasAns = vidNames(start_Index:end_Index, 15)

    parameters.trainS1 = vidNames(start_Index:end_Index, 16)

    parameters.trainS2 = vidNames(start_Index:end_Index, 18)

    parameters.trainS3 = vidNames(start_Index:end_Index, 20)

    parameters.mTestAns = vidNames(start_Index:end_Index, 23)

    parameters.pTestAns = vidNames(start_Index:end_Index, 25)

    parameters.movieLenght = vidNames(start_Index:end_Index, 26)
    
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        
%     %Make video files (takes the video names from the .csv file)


    % ORIGINAL
%     parameters.TargetMoviePath = vidNames(start_Index:end_Index, 10)
%     parameters.DistractorMoviePath = vidNames(start_Index:end_Index, 11)
%     parameters.SignMoviePath = vidNames(start_Index:end_Index, 12)
%     parameters.LeftMovie = vidNames(start_Index:end_Index, 13)
    
    
    %Trying to make new ones 

    parameters.ambigV = vidNames(start_Index:end_Index, 11)
    parameters.mbiasV = vidNames(start_Index:end_Index, 12)
    parameters.pbias = vidNames(start_Index:end_Index, 14)
    parameters.trainV1 = vidNames(start_Index:end_Index, 17)
    parameters.trainV2 = vidNames(start_Index:end_Index, 19)
    parameters.trainV3 = vidNames(start_Index:end_Index, 21)
    parameters.mTest = vidNames(start_Index:end_Index, 22)
    parameters.pTest = vidNames(start_Index:end_Index, 24)
    parameters.LeftMovie = vidNames(start_Index:end_Index, 27)
  
    
    
    
    
%     
% %     %Now randomize everything (apply random order to all columns/objects)


%ORIGINAL
%     myRandOrder = randperm(14) %This makes a list of the numbers 1-14, in a random order
%     parameters.Item = parameters.Item(myRandOrder);
%     parameters.Contrast = parameters.Contrast(myRandOrder);
%     parameters.Type_Target = parameters.Type_Target(myRandOrder);
%     parameters.Target = parameters.Target(myRandOrder);
%     parameters.Distractor = parameters.Distractor(myRandOrder);
%     parameters.Cohort = parameters.Cohort(myRandOrder);
%     parameters.SignerID = parameters.SignerID(myRandOrder);
%     parameters.TargetMoviePath = parameters.TargetMoviePath(myRandOrder);
%     parameters.DistractorMoviePath = parameters.DistractorMoviePath(myRandOrder);
%     parameters.SignMoviePath = parameters.SignMoviePath(myRandOrder);
    
% NEW
    myRandOrder = randperm(27)
    parameters.amyFileName = parameters.amyFileName(myRandOrder)
    parameters.itemID = parameters.itemID(myRandOrder);
    parameters.eventType = parameters.eventType(myRandOrder);
    parameters.Condition = parameters.Condition(myRandOrder);
    parameters.Manner = parameters.Manner(myRandOrder);
    parameters.Path = parameters.Path(myRandOrder);
    parameters.verbName = parameters.verbName(myRandOrder);
    parameters.verbMeaning = parameters.verbMeaning(myRandOrder);
    parameters.ambigS = parameters.ambigS(myRandOrder);
    parameters.mbiasAns = parameters.mbiasAns(myRandOrder);
    parameters.pbiasAns = parameters.pbiasAns(myRandOrder);
    parameters.trainS1 = parameters.trainS1(myRandOrder);
    parameters.trainS2 = parameters.trainS2(myRandOrder);
    parameters.trainS3 = parameters.trainS3(myRandOrder);
    parameters.mTestAns = parameters.mTestAns(myRandOrder);
    parameters.pTestAns = parameters.pTestAns(myRandOrder);
    parameters.movieLenght = parameters.movieLenght(myRandOrder);
    parameters.ambigV = parameters.ambigV(myRandOrder);
    parameters.mbiasV = parameters.mbiasV(myRandOrder);
    parameters.pbias = parameters.pbias(myRandOrder);
    parameters.trainV1 = parameters.trainV1(myRandOrder);
    parameters.trainV2 = parameters.trainV2(myRandOrder);
    parameters.trainV3 = parameters.trainV3(myRandOrder);
    parameters.mTest = parameters.mTest(myRandOrder);
    parameters.pTest = parameters.pTest(myRandOrder);
   parameters.LeftMovie = parameters.LeftMovie(myRandOrder)
    
       
    %Randomize sides for target and distractor movies
    %parameters.LeftMovie = {'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D'}
    %newRand = randperm(1); %how many trials'
    %parameters.LeftMovie = parameters.LeftMovie(newRand);
    
    %%%%%%%%%%%%%%%%%%%%%%
    % Experiment
    %%%%%%%%%%%%%%%%%%%%%%

    %%%%%%%%%%%%%%%%%%%%%%
    % Prelim Screen/Instructions
    %%%%%%%%%%%%%%%%%%%%%%
    
     Text_Show('Press spacebar to start experiment.')
     Take_Response();    
    
     
  
         
     
     %Save a header file to the data file so it will be easier to read!
     WriteResultFile({'SubjectNo',...
         'trialNo',...
         'LeftMovie',...
         'Response'}); 
    
    %%%%%%%%%%%%%%%%%%%%%%
    % Trial Setup
    %%%%%%%%%%%%%%%%%%%%%%
    
    
    Text_Show('Ready? Press space to watch the movies.');
    response = Take_Response();
    %Want to finish early?
    if response == 'q'
        return
    end                                                                                                                                                                                                                                                                                                                                                                         
    
    
     
     %ntrials = length(parameters.pbias) %how many trials'
     ntrials = 1; %For the skeleton, play some short sample trials!
        
     for i=1:ntrials
         Text_Show(char(parameters.ambigS(i)));
         Take_Response();                       
          response = Sample_Trial(i);  
         if response == 'q'                       
             break            
         end
         WriteResultFile({parameters.subNo, ...
             i, ...
             response}) %Note the curly brackets - this needs to be a cellarray of stuff you want to save
         
     end

    %%%%%%%%%%%%%%%%%%%%%%
    % Cleanup & Shutdown
    %%%%%%%%%%%%%%%%%%%%%%
    
     Closeout_PTool();
     
catch
    
    % Catch error: in case anything went wrong...
    % Do same cleanup as at the end of a regular session...
    Closeout_PTool();
    
    % Output the error message that describes the error:
    psychrethrow(psychlasterror);

end

end

